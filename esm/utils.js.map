{"version":3,"sources":["../src/utils.js"],"names":["arrayType","observable","array","Array","isArray","_isArray","v","defComputed","obj","key","get","set","Object","defineProperty","enumerable","configurable","Error","isFunction","fn","parseExpr","ctx","expr","exps","split","parent","some","exp","i","length","undefined","camelize","str","replace","_","c","toUpperCase","iterativeParent","callback","componentClass","parentNode","_reactInternalFiber","return","vm","nodeType","stateNode","warn","msg","trace","generateComponentTrace","config","warnHandler","call","silent","console","error","logError","err","info","process","env","NODE_ENV","toString","global","globalHandleError","errorHandler","e","handleError","cur","hooks","$listeners","capture","$parent","classifyRE","classify","formatComponentName","includeFile","$root","name","getComponentName","repeat","n","res","_isVue","tree","currentRecursiveSequence","last","constructor","push","map","join","type","_type","displayName"],"mappings":"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","sourcesContent":["import { observable } from 'mobx';\nimport config from './config';\n\nexport { runInAction } from 'mobx';\n\n// isArray support ObservableArray\nconst arrayType = observable.array([11, 22]);\nif (!Array.isArray(arrayType)) {\n  const _isArray = Array.isArray;\n  Array.isArray = function (v) {\n    return _isArray(v) || (v instanceof Array);\n  };\n}\n\nexport function defComputed(obj, key, get, set) {\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get,\n    set: set || function (v) { throw new Error(`computed props: ${key} is readonly!`); }\n  });\n}\n\nexport function isFunction(fn) {\n  return typeof fn === 'function';\n}\n\nexport function parseExpr(ctx, expr) {\n  if (!expr) return {};\n  const exps = expr.split('.');\n  let parent = ctx;\n  let obj; let key;\n  exps.some((exp, i) => {\n    if (i === exps.length - 1) {\n      obj = parent;\n      key = exp;\n      return true;\n    }\n\n    let v = parent[exp];\n    if (v === undefined) return true;\n\n    parent = v;\n  });\n  return { obj, key };\n}\n\nexport function camelize(str) {\n  return str.replace(/-(\\w)/g, function (_, c) { return c ? c.toUpperCase() : ''; });\n}\n\nexport function iterativeParent(ctx, callback, componentClass) {\n  let parentNode = ctx._reactInternalFiber && ctx._reactInternalFiber.return;\n  while (parentNode) {\n    const vm = parentNode.nodeType === undefined && parentNode.stateNode;\n    if (vm && (!componentClass || vm instanceof componentClass)) {\n      if (callback(vm)) break;\n    }\n    parentNode = parentNode.return;\n  }\n}\n\nfunction warn(msg, vm) {\n  let trace = vm ? generateComponentTrace(vm) : '';\n\n  if (config.warnHandler) {\n    config.warnHandler.call(null, msg, vm, trace);\n  } else if (!config.silent) {\n    console.error(('[Vue warn]: ' + msg + trace));\n  }\n}\n\nfunction logError(err, vm, info) {\n  if (process.env.NODE_ENV !== 'production') {\n    warn(('Error in ' + info + ': \"' + (err.toString()) + '\"'), vm);\n  }\n  if (typeof global.console !== 'undefined') {\n    console.error(err);\n  } // else throw err;\n}\n\nfunction globalHandleError(err, vm, info) {\n  if (config.errorHandler) {\n    try {\n      return config.errorHandler.call(null, err, vm, info);\n    } catch (e) {\n      // if the user intentionally throws the original error in the handler,\n      // do not log it twice\n      if (e !== err) {\n        logError(e, null, 'config.errorHandler');\n      }\n    }\n  }\n  logError(err, vm, info);\n}\n\nexport function handleError(err, vm, info) {\n  if (vm) {\n    let cur = vm;\n    do {\n      let hooks = cur.$listeners['hook:errorCaptured'];\n      if (hooks) {\n        for (let i = 0; i < hooks.length; i++) {\n          try {\n            let capture = hooks[i].call(cur, err, vm, info) === false;\n            if (capture) { return; }\n          } catch (e) {\n            globalHandleError(e, cur, 'errorCaptured hook');\n          }\n        }\n      }\n    } while (cur = cur.$parent);\n  }\n  globalHandleError(err, vm, info);\n}\n\nlet classifyRE = /(?:^|[-_])(\\w)/g;\nfunction classify(str) {\n  return str\n    .replace(classifyRE, function (c) { return c.toUpperCase(); })\n    .replace(/[-_]/g, '');\n}\n\nfunction formatComponentName(vm, includeFile) {\n  if (vm.$root === vm) return '<Root>';\n  let name = getComponentName(vm);\n  return name ? ('<' + (classify(name)) + '>') : '<Anonymous>';\n}\n\nfunction repeat(str, n) {\n  let res = '';\n  while (n) {\n    if (n % 2 === 1) { res += str; }\n    if (n > 1) { str += str; }\n    n >>= 1;\n  }\n  return res;\n}\n\nfunction generateComponentTrace(vm) {\n  if (vm._isVue && vm.$parent) {\n    let tree = [];\n    let currentRecursiveSequence = 0;\n    while (vm) {\n      if (tree.length > 0) {\n        let last = tree[tree.length - 1];\n        if (last.constructor === vm.constructor) {\n          currentRecursiveSequence++;\n          vm = vm.$parent;\n          continue;\n        } else if (currentRecursiveSequence > 0) {\n          tree[tree.length - 1] = [last, currentRecursiveSequence];\n          currentRecursiveSequence = 0;\n        }\n      }\n      tree.push(vm);\n      vm = vm.$parent;\n    }\n    return '\\n\\nfound in\\n\\n' + tree\n      .map(function (vm, i) {\n        return ('' + (i === 0 ? '---> ' : repeat(' ', 5 + i * 2)) + (Array.isArray(vm)\n          ? ((formatComponentName(vm[0])) + '... (' + (vm[1]) + ' recursive calls)')\n          : formatComponentName(vm)));\n      })\n      .join('\\n');\n  }\n  return ('\\n\\n(found in ' + (formatComponentName(vm)) + ')');\n}\n\nfunction getComponentName(vm) {\n  const type = vm && vm._type;\n  return type ? (type.displayName || type.name) : '<Anonymous>';\n}\n"],"file":"utils.js"}